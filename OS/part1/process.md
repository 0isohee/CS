# 프로세스와 스레드
<br/>

### 프로세스
컴퓨터에서 실행 중인 하나의 프로그램을 의미하며, 프로그램은 특정 작업을 수행하기 위한 명령어의 집합이다.
프로세스는 OS로부터 독립된 메모리 영역을 할당 받고, 다른 영역에는 접근할 수 없다.

### 프로세스의 메모리 영역 구조
<img width="400" alt="스크린샷 2024-07-29 오전 11 07 11" src="https://github.com/user-attachments/assets/5e621973-9048-49e8-a570-17ca114f541b"><br/>
1. 스택 : **LIFO** 으로 동작, 지역 변수, 함수의 매개변수, 반환되는 주소 값들이 저장되는 영역<br/>
2. 힙 : **FIFO** 으로 동작, 사용자에 의해 동적 메모리 할당이 일어나는 영역으로, malloc() 으로 할당되는 영역<br/>
3. 데이터 : 전역 변수, 정적 변수, 배열, 구조체 등이 저장되는 영역, **BSS(Block Stated Symbol)** 으로 초기화 되지 않은 영역과 초기화 된 영역으로 세분화됨<br/>
4. 코드 : 실행할 코드가 기계어로 컴파일 되어 동작하는 영역으로, 텍스트 영역이라 한다.<br/>

- 스택 영역이 힙 영역을 침범하는 것이 **스택 오버플로**, 힙 영역이 스택 영역을 침범하는 것을 **힙 오버플로** 라고 한다.
<br/>

### 스레드
스레드는 프로세스에서 실제로 실행되는 흐름의 단위를 의미. <br/>
스레드는 프로세스 안에 존재하기에, 프로세스의 메모리 공간을 이용하고, 지역 변수를 저장하는 스택 영역을 할당 받음. <br/>
전역 변수를 저장하는 힙 영역은 다른 스레드와 공유함
<br/>

### PCB (Process Control Block)
OS는 프로세스를 제어하기 위한 프로세스 정보를 저장하는데, 이를 PCB 라고 함. <br/>
프로세스의 현재 상태, 프로세스를 나타내는 고유의 Process ID, 다음 프로그램의 명령어 주소인 PC, 메모리 제한 등을 관리함<br/>

### 프로세스의 생성
새로운 프로세스는 기존 프로세스에서 fork() 함수를 호출해 생성함. <br/>
fork() 함수에는 함수를 호출한 프로세스를 복사하는 기능이 있음. 이때, 기존 프로세스를 부모, 복사된 프로세스를 자식 프로세스라고 함<br/>

함수 값 반환 예시
```
#include <stdio.h>
#include <unistd.h>

int main() {
  printf("Start!\n");
  int forkRet = fork();

  if (forkRet == 0){
    printf("child process : %d\n",getpid());
  } else {
    printf("forkRet : %d, parent process : %d\n", forkRet, getpid());
  }

  return 0;
}
```
<br/>
실행 결과
> Start! <br/>
> forkRet : 136, parent process : 135 <br/>
> child process : 136
<br/>

처음 부모에서 Start! 실행 후, fork() 실행시, 자식의 프로세스를 생성하게 됨. <br/>
따라서, 반환값은 자식의 PID인 136이 되고, else 문에 들어가서 출력문을 출력하게 됨 <br/>
자식 프로세스는 부모가 호출한 시점에 생성됨으로 반환값이 0이 되어 if문 안에 들어가게 되고, <br/>
자신의 PID을 호출하며 함수가 끝이 난다.
